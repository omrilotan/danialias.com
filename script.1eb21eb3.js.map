{"version":3,"sources":["script.js"],"names":["count","utiliseForm","nodes","error","document","createElement","amend","waiting","success","failed","contactme","className","appendChild","createTextNode","contactLink","setAttribute","onsubmit","event","preventDefault","parentNode","removeChild","replaceChild","data","form","reduce","call","accumulator","name","value","Object","assign","trim","subject","contact","insertBefore","date","Date","toUTCString","fetch","action","headers","method","mode","cache","credentials","redirect","referrer","body","JSON","stringify","then","response","ok","Error","catch","err","setTimeout","forEach","querySelectorAll","replaceAnchorBehaviour","anchor","addEventListener","querySelector","getAttribute","replace","scrollIntoView","behavior","loadMap","frame","prop","readyState","window","once","scrollY","innerHeight"],"mappings":"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","file":"script.1eb21eb3.js","sourceRoot":"../src","sourcesContent":["let count = 0;\n\nif (document.readyState === 'complete') {\n\tutiliseForm();\n} else {\n\twindow.addEventListener('DOMContentLoaded', utiliseForm, { once: true });\n}\n\nif (window.scrollY > window.innerHeight) {\n\tloadMap();\n} else {\n\twindow.addEventListener('scroll', loadMap, { once: true });\n}\n\nfunction utiliseForm() {\n\tvar nodes = {\n\t\terror: document.createElement('p'),\n\t\tamend: document.createElement('p'),\n\t\twaiting: document.createElement('p'),\n\t\tsuccess: document.createElement('h3'),\n\t\tfailed: document.createElement('h3'),\n\t\tcontactme: contactme\n\t};\n\tnodes.error.className = 'error';\n\tnodes.error.appendChild(document.createTextNode('Something went wrong, please try again.'));\n\tnodes.amend.className = 'error';\n\tnodes.amend.appendChild(document.createTextNode('Please fill out name and contact method.'));\n\tnodes.waiting.appendChild(document.createTextNode('Thank you'));\n\tnodes.success.appendChild(document.createTextNode('I will return to you shortly'));\n\tnodes.failed.appendChild(document.createTextNode('Sorry, the form was not sent.'));\n\tvar contactLink = document.createElement('a');\n\tcontactLink.setAttribute('href', '#address')\n\tcontactLink.appendChild(document.createTextNode('Please try a different contact method.'));\n\tnodes.failed.appendChild(document.createElement('br'))\n\tnodes.failed.appendChild(contactLink);\n\n\tnodes.contactme.onsubmit = function(event) {\n\t\tevent.preventDefault();\n\n\t\tnodes.error.parentNode && nodes.error.parentNode.removeChild(nodes.error);\n\t\tnodes.amend.parentNode && nodes.amend.parentNode.removeChild(nodes.amend);\n\t\tnodes.contactme.parentNode.replaceChild(nodes.waiting, nodes.contactme);\n\n\t\tvar data = serialise(nodes.contactme);\n\t\tdata.subject = 'Message from danisilas.com'\n\n\t\tif (!data.name || !data.contact) {\n\t\t\tnodes.waiting.parentNode.replaceChild(nodes.contactme, nodes.waiting);\n\t\t\tnodes.contactme.parentNode.insertBefore(nodes.amend, nodes.contactme);\n\t\t\treturn;\n\t\t}\n\n\t\tdata.date = new Date().toUTCString();\n\n\t\tfetch(\n\t\t\t\tnodes.contactme.action,\n\t\t\t\t{\n\t\t\t\t\theaders: {'Content-Type': 'application/json; charset=utf-8'},\n\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\tmode: 'cors',\n\t\t\t\t\tcache: 'no-cache',\n\t\t\t\t\tcredentials: 'same-origin',\n\t\t\t\t\tredirect: 'follow',\n\t\t\t\t\treferrer: 'no-referrer',\n\t\t\t\t\tbody: JSON.stringify(data)\n\t\t\t\t}\n\t\t).then(function (response) {\n\t\t\tif (!response.ok) {\n\t\t\t\tthrow new Error('Request failed');\n\t\t\t}\n\t\t\tnodes.waiting.parentNode.replaceChild(nodes.success, nodes.waiting);\n\t\t}).catch(function (err) {\n\t\t\tif (count > 3) {\n\t\t\t\tnodes.waiting.parentNode.replaceChild(nodes.failed, nodes.waiting);\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tconst error = new Error('Failed to send contact form');\n\t\t\tsetTimeout(function() { throw error; });\n\n\t\t\tnodes.waiting.parentNode.replaceChild(nodes.contactme, nodes.waiting);\n\t\t\tnodes.contactme.parentNode.insertBefore(nodes.error, nodes.contactme);\n\t\t\tcount++\n\t\t});\n\t}\n\n\tfunction serialise(form) {\n\t\treturn [].reduce.call(\n\t\t\t\tform,\n\t\t\t\t(accumulator, {name, value}) => value ? Object.assign(\n\t\t\t\t\taccumulator,\n\t\t\t\t\t{ [name]: value.trim() }\n\t\t\t\t) : accumulator,\n\t\t\t\t{}\n\t\t\t);\n\t}\n\n\t[].forEach.call(\n\t\tdocument.querySelectorAll('a[href^=\"#\"]'),\n\t\treplaceAnchorBehaviour\n\t);\n\n\treplaceAnchorBehaviour(contactLink);\n}\n\nfunction replaceAnchorBehaviour(anchor) {\n\tanchor.addEventListener('click', function(event) {\n\t\tevent.preventDefault();\n\n\t\tvar destination = document.querySelector('[name=\"' + anchor.getAttribute('href').replace('#', '') + '\"]');\n\n\t\tdestination.scrollIntoView({behavior: 'smooth'});\n\t});\n}\n\nfunction loadMap() {\n\tconst frame = document.createElement('iframe');\n\t[\n\t\t[ 'title', 'My Office Location' ],\n\t\t[ 'width', '100%' ],\n\t\t[ 'height', '100%' ],\n\t\t[ 'src', 'https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2478.7957283073088!2d-0.1435368157730345!3d51.590307079648746!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x48761b3e977d91b5%3A0xf02ada7628d85293!2sDan%20I%20Silas%20Chartered%20Surveyor!5e0!3m2!1siw!2sil!4v1594805579242!5m2!1siw!2sil' ],\n\t\t[ 'frameborder', '0'] ,\n\t\t[ 'scrolling', 'no'] ,\n\t\t[ 'marginheight', '0'] ,\n\t\t[ 'marginwidth', '0']\n\t].forEach(\n\t\t([ prop, value ]) => frame.setAttribute(prop, value)\n\t);\n\tdocument.querySelector('footer').appendChild(frame);\n}\n"]}